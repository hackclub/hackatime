<%
  modal_id ||= "modal-#{SecureRandom.hex(4)}"
  icon_svg ||= nil
  icon_color ||= 'text-primary'
  title ||= 'Confirm'
  description ||= nil
  buttons ||= []
  max_width ||= 'max-w-md'
  custom ||= nil
%>

<div id="<%= modal_id %>" class="fixed inset-0 flex items-center justify-center z-9999 opacity-0 pointer-events-none transition-opacity duration-300 ease-in-out hidden" style="background-color: rgba(0, 0, 0, 0.5);backdrop-filter: blur(4px);" data-controller="modal">
  <div class="bg-dark border border-primary rounded-lg p-6 <%= max_width %> w-full mx-4 flex flex-col items-center justify-center transform scale-95 transition-transform duration-300 ease-in-out" data-modal-target="content">
    <div class="flex flex-col items-center w-full">
      <% if icon_svg %>
        <div class="mb-4 flex justify-center w-full">
          <svg class="w-12 h-12 <%= icon_color %>" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <%= sanitize icon_svg, tags: %w[path circle rect line polyline polygon], attributes: %w[d cx cy r x y x1 y1 x2 y2 points stroke-linecap stroke-linejoin stroke-width fill] %>
          </svg>
        </div>
      <% end %>

      <h3 class="text-2xl font-bold text-surface-content mb-2 text-center w-full"><%= title %></h3>

      <% if description %>
        <p class="text-muted mb-6 text-center w-full"><%= description %></p>
      <% end %>

      <% if custom.is_a?(String) %>
        <%= sanitize custom, tags: %w[div p span a button form input label select option textarea h1 h2 h3 h4 h5 h6 ul ol li strong em code pre], attributes: %w[class id href type name value placeholder data-controller data-action data-target data-token for method required disabled readonly accept maxlength action] %>
      <% elsif custom.present? %>
        <%= custom %>
      <% end %>

      <% if buttons.any? %>
        <div class="flex w-full gap-3">
          <% buttons.each do |button| %>
            <div class="flex-1 min-w-0">
              <% if button[:form] %>
                <% if button[:form_id] %>
                  <button type="submit" form="<%= button[:form_id] %>" class="w-full h-10 px-4 rounded-lg transition-colors duration-200 font-medium cursor-pointer m-0 <%= button[:class] %>">
                    <%= button[:text] %>
                  </button>
                <% else %>
                  <form method="post" action="<%= button[:url] %>" class="m-0">
                    <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
                    <% if button[:method] && button[:method] != 'post' %>
                      <input type="hidden" name="_method" value="<%= button[:method] %>">
                    <% end %>
                    <button type="submit" class="w-full h-10 px-4 rounded-lg transition-colors duration-200 font-medium cursor-pointer m-0 <%= button[:class] %>">
                      <%= button[:text] %>
                    </button>
                  </form>
                <% end %>
              <% else %>
                <button type="button" data-action="<%= button[:action] || 'click->modal#close' %>" class="w-full h-10 px-4 rounded-lg transition-colors duration-200 cursor-pointer m-0 <%= button[:class] %>">
                  <%= button[:text] %>
                </button>
              <% end %>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
</div>
