<div class="max-w-6xl mx-auto px-3 py-4 sm:p-6">
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-white mb-4">Leaderboard</h1>

    <div class="inline-flex rounded-full p-1 mb-4">
      <%= link_to 'Last 24 Hours', leaderboards_path(period_type: 'daily'), class: "px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 #{@period_type == :daily ? 'bg-primary text-white' : 'text-muted bg-darkless hover:text-white'}" %>
      <%= link_to 'Last 7 Days', leaderboards_path(period_type: 'last_7_days'), class: "px-4 py-2 rounded-full text-sm font-medium transition-all duration-200 #{@period_type == :last_7_days ? 'bg-primary text-white' : 'text-muted bg-darkless hover:text-white'}" %>
    </div>

    <% if current_user && current_user.github_uid.blank? %>
      <div class="bg-darker border border-primary rounded-lg p-4 mb-6 flex flex-col sm:flex-row sm:items-center gap-3">
        <span class="text-white">Connect your GitHub to qualify for the leaderboard.</span>
        <%= link_to 'Connect GitHub', '/auth/github', class: 'bg-primary hover:bg-primary/75 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200 text-center shrink-0 w-fit' %>
      </div>
    <% end %>

    <div class="text-muted text-sm">
      <% if @leaderboard %>
        <%= @leaderboard.date_range_text %>

        <% if @leaderboard.finished_generating? && @leaderboard.persisted? %>
          <span class="italic"> - Updated <%= time_ago_in_words(@leaderboard.updated_at) %> ago. </span>
        <% end %>
      <% else %>
        <%=
          case @period_type
          when :last_7_days
            "#{(Date.current - 6.days).strftime('%B %d')} - #{Date.current.strftime('%B %d, %Y')}"
          else
            Date.current.strftime('%B %d, %Y')
          end
        %>
      <% end %>
    </div>
  </div>

  <div class="bg-elevated rounded-xl border border-primary overflow-hidden">
    <% if @leaderboard&.persisted? %>
      <% if @total_entries && @total_entries > 0 %>
        <div id="leaderboard-entries" class="divide-y divide-gray-800" data-controller="infinite-scroll" data-infinite-scroll-url-value="<%= entries_leaderboards_path(period_type: @period_type) %>" data-infinite-scroll-page-value="1" data-infinite-scroll-total-value="<%= @total_entries %>">
          <%= render 'loading' %>
        </div>
      <% else %>
        <div class="py-16 text-center">
          <h3 class="text-xl font-medium text-white mb-2">No data available</h3>
          <p class="text-muted">Check back later for <%= @period_type == :last_7_days ? 'the last 7 days' : 'the last 24 hours' %> results!</p>
        </div>
      <% end %>
      <% unless @user_on_leaderboard && @untracked_entries != 0 %>
        <div class="px-4 py-3 text-sm text-muted border-t border-primary">
          Don't see yourself on the leaderboard? You're probably one of the
          <%= pluralize(@untracked_entries, 'user') %>
          who haven't
          <%= link_to 'updated their wakatime config', my_settings_path, target: '_blank', class: 'text-accent hover:text-cyan-400 transition-colors' %>.
        </div>
      <% end %>
      <% if @leaderboard.finished_generating? %>
        <div class="px-4 py-2 text-xs italic text-muted border-t border-primary">Generated in <%= @leaderboard.finished_generating_at - @leaderboard.created_at %> seconds</div>
      <% end %>
    <% else %>
      <div class="py-16 text-center">
        <h3 class="text-xl font-medium text-white mb-2">No data available</h3>
        <p class="text-muted">Check back later for <%= @period_type == :last_7_days ? 'the last 7 days' : 'the last 24 hours' %> results!</p>
      </div>
    <% end %>
  </div>
</div>
