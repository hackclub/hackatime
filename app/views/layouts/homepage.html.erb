<!DOCTYPE html>
<html class="<%= Rails.env == "production" ? "production" : "development" %>" data-theme="dark">
  <head>
    <title><%= @page_title || content_for(:title) || "Hackatime" %></title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="color-scheme" content="dark">

    <!-- SEO Meta Tags -->
    <meta name="description" content="<%= @meta_description || content_for(:meta_description) || 'Track your coding time easily with Hackatime. A free tool to see how much time you spend programming in different languages and editors. Better than WakaTime and totally free!' %>">
    <meta name="keywords" content="<%= @meta_keywords || content_for(:meta_keywords) || 'coding time tracker, programming stats, wakatime alternative, free time tracking, code statistics, developer analytics, programming time, coding productivity' %>">
    <meta name="author" content="Hack Club">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="<%= content_for(:canonical_url) || request.original_url %>">

    <!-- Enhanced SEO -->
    <meta name="theme-color" content="#ec3750">
    <meta name="msapplication-TileColor" content="#ec3750">

    <!-- Open Graph Tags -->
    <meta property="og:title" content="<%= @og_title || content_for(:og_title) || @page_title || content_for(:title) || 'Hackatime - Free Coding Time Tracker' %>">
    <meta property="og:description" content="<%= @og_description || content_for(:og_description) || @meta_description || content_for(:meta_description) || 'Track your coding time easily with Hackatime. A free tool to see how much time you spend programming. Better than WakaTime!' %>">
    <meta property="og:url" content="<%= content_for(:og_url) || request.original_url %>">
    <meta property="og:type" content="<%= content_for(:og_type) || 'website' %>">
    <meta property="og:image" content="<%= content_for(:og_image) || asset_path('favicon.png') %>">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:site_name" content="Hackatime">
    <meta property="og:locale" content="en_US">

    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@hackclub">
    <meta name="twitter:creator" content="@hackclub">
    <meta name="twitter:title" content="<%= @twitter_title || content_for(:twitter_title) || @page_title || content_for(:title) || 'Hackatime - Free Coding Time Tracker' %>">
    <meta name="twitter:description" content="<%= @twitter_description || content_for(:twitter_description) || @meta_description || content_for(:meta_description) || 'Track your coding time easily with Hackatime. A free tool to see how much time you spend programming. Better than WakaTime!' %>">
    <meta name="twitter:image" content="<%= content_for(:twitter_image) || asset_path('favicon.png') %>">

    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <% if current_user %>
      <meta name="user-is-superadmin" content="<%= current_user.admin_level == "superadmin" %>">
      <meta name="user-is-admin" content="<%= current_user.admin_level == "admin" %>">
      <meta name="user-is-viewer" content="<%= current_user.admin_level == "viewer" %>">
    <% end %>

    <%= yield :head %>

    <%= favicon_link_tag asset_path('favicon.png'), type: 'image/png' %>

    <script defer data-domain="hackatime.hackclub.com" src="https://plausible.io/js/script.file-downloads.hash.js"></script>

    <%= stylesheet_link_tag :app %>
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "homepage", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
    <%= Sentry.get_trace_propagation_meta.html_safe %>
  </head>

  <body style="background: #1a1a2e; margin: 0; padding: 0; overflow-x: hidden;">
    <% flash.each do |name, msg| %>
      <% c = case name.to_sym
      when :notice
        "border: 2px solid #10b981; color: #10b981;"
      else
        "border: 2px solid #ec3750; color: #ec3750;"
      end %>
      <div style="position: fixed; top: 1rem; left: 50%; transform: translateX(-50%); z-index: 9999; background: #1f2937; border-radius: 0.5rem; padding: 1rem 1.5rem; <%= c %>">
        <%= msg %>
      </div>
    <% end %>

    <%= yield %>

    <div id="logout-modal" class="fixed inset-0 flex items-center justify-center z-[9999] opacity-0 pointer-events-none transition-opacity duration-300 ease-in-out hidden" style="background-color: rgba(0, 0, 0, 0.5);backdrop-filter: blur(4px);">
      <div class="bg-dark border border-primary rounded-lg p-6 max-w-md w-full mx-4 flex flex-col items-center justify-center transform scale-95 transition-transform duration-300 ease-in-out">
        <div class="flex flex-col items-center w-full">
          <div class="mb-4 flex justify-center w-full">
            <svg class="w-12 h-12 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path fill="currentColor" d="M5 5h6c.55 0 1-.45 1-1s-.45-1-1-1H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h6c.55 0 1-.45 1-1s-.45-1-1-1H5z" /><path fill="currentColor" d="m20.65 11.65l-2.79-2.79a.501.501 0 0 0-.86.35V11h-7c-.55 0-1 .45-1 1s.45 1 1 1h7v1.79c0 .45.54.67.85.35l2.79-2.79c.2-.19.2-.51.01-.7" />
            </svg>
          </div>
          <h3 class="text-xl font-bold text-white mb-2 text-center w-full">Woah hold on a sec</h3>
          <p class="text-gray-300 mb-6 text-center w-full">You sure you want to sign out? You can sign back in later but that is a bit of a hassle...</p>
          <div class="flex w-full h-[40px] gap-3">
            <button id="cancel-logout" class="flex-1 px-4 py-2 border border-gray-600 text-gray-300 rounded-lg hover:bg-darkless transition-colors duration-200 cursor-pointer m-0 h-[40px]">
              nevermind
            </button>
            <form method="post" action="<%= signout_path %>" class="flex-1">
              <%= hidden_field_tag :authenticity_token, form_authenticity_token %>
              <input type="hidden" name="_method" value="delete">
              <button type="submit" class="w-full px-4 py-2 bg-primary text-white rounded-lg hover:bg-red-600 transition-colors duration-200 font-medium cursor-pointer m-0 h-[40px]">
                get me outta here
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
