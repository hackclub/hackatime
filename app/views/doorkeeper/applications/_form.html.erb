<%= form_for application, url: doorkeeper_submit_path(application), as: :doorkeeper_application, html: { class: 'space-y-6' } do |f| %>
  <% if application.errors.any? %>
    <div class="p-4 bg-red/10 border border-red/20 rounded-lg">
      <div class="flex items-center gap-2 text-red mb-2">
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
        </svg>
        <span class="font-medium"><%= t('doorkeeper.applications.form.error') %></span>
      </div>
      <ul class="list-disc list-inside text-red/80 text-sm">
        <% application.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="border border-primary rounded-xl p-6 bg-dark">
    <div class="flex items-center gap-3 mb-6">
      <div class="p-2 bg-primary/10 rounded">
        <svg class="w-6 h-6 text-primary" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
        </svg>
      </div>
      <h2 class="text-xl font-semibold text-white">Application Details</h2>
    </div>

    <div class="space-y-5">
      <div>
        <%= f.label :name, class: "block text-sm font-medium text-white mb-2" %>
        <% if application.persisted? && application.verified? %>
          <%= f.text_field :name,
              class: "w-full px-3 py-2 bg-darkless/50 border border-darkless rounded text-secondary cursor-not-allowed",
              disabled: true %>
          <%= f.hidden_field :name %>
          <p class="mt-2 text-xs text-yellow flex items-center gap-1.5">
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd" />
            </svg>
            Name is locked for verified applications. Contact a super admin to change it.
          </p>
        <% else %>
          <%= f.text_field :name,
              class: "w-full px-3 py-2 bg-darkless border border-darkless rounded text-white focus:border-primary focus:ring-1 focus:ring-primary placeholder-secondary",
              placeholder: "My Awesome App",
              required: true %>
        <% end %>
        <% if application.errors[:name].present? %>
          <p class="mt-1 text-xs text-red"><%= application.errors[:name].to_sentence %></p>
        <% end %>
      </div>

      <div>
        <%= f.label :redirect_uri, "Redirect URIs", class: "block text-sm font-medium text-white mb-2" %>
        <%= f.text_area :redirect_uri,
            class: "w-full px-3 py-2 bg-darkless border border-darkless rounded text-white focus:border-primary focus:ring-1 focus:ring-primary placeholder-secondary font-mono text-sm",
            placeholder: "https://example.com/auth/callback",
            rows: 3 %>
        <% if application.errors[:redirect_uri].present? %>
          <p class="mt-1 text-xs text-red"><%= application.errors[:redirect_uri].to_sentence %></p>
        <% end %>
        <p class="mt-2 text-xs text-secondary">
          <%= t('doorkeeper.applications.help.redirect_uri') %>
        </p>
        <% if Doorkeeper.configuration.allow_blank_redirect_uri?(application) %>
          <p class="mt-1 text-xs text-secondary">
            <%= t('doorkeeper.applications.help.blank_redirect_uri') %>
          </p>
        <% end %>
      </div>

      <div>
        <%= f.label :scopes, class: "block text-sm font-medium text-white mb-2" %>
        <%= f.text_field :scopes,
            class: "w-full px-3 py-2 bg-darkless border border-darkless rounded text-white focus:border-primary focus:ring-1 focus:ring-primary placeholder-secondary font-mono text-sm",
            placeholder: "profile read" %>
        <% if application.errors[:scopes].present? %>
          <p class="mt-1 text-xs text-red"><%= application.errors[:scopes].to_sentence %></p>
        <% end %>
        <p class="mt-2 text-xs text-secondary">
          <%= t('doorkeeper.applications.help.scopes') %>
        </p>
      </div>

      <div class="flex items-start gap-3 p-4 bg-darkless border border-darkless rounded">
        <%= f.check_box :confidential,
            class: "mt-0.5 w-4 h-4 text-primary border-darkless rounded focus:ring-primary bg-darker" %>
        <div>
          <%= f.label :confidential, "Confidential Application", class: "text-sm font-medium text-white" %>
          <p class="mt-1 text-xs text-secondary">
            <%= t('doorkeeper.applications.help.confidential') %>
          </p>
        </div>
      </div>
    </div>
  </div>

  <div class="flex items-center gap-3">
    <%= f.submit t('doorkeeper.applications.buttons.submit'),
        class: "px-6 py-2 bg-primary text-white font-medium rounded transition-colors duration-200 hover:opacity-90 cursor-pointer" %>
    <%= link_to t('doorkeeper.applications.buttons.cancel'), oauth_applications_path,
        class: "px-6 py-2 border border-darkless text-white font-medium rounded transition-colors duration-200 hover:bg-darkless" %>
  </div>
<% end %>
